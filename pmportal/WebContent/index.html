<!DOCTYPE HTML>
<html lang="en">
<head>
<title>PMPortal Dashboard</title>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="style/main.css">
<script type="text/javascript" src="scripts/jquery-3.0.0.js"></script>
</head>
<body>
	<div class="row">
		<div class="col-lg-6 col-lg-offset-3" id="login">
			<h2>PMPortal Login</h2>

			<div id="loginInput">
				<span class="inputTag">Username</span> <br> <input type="text"
					id="uname" /> <br> <span class="inputTag">Password</span> <br>
				<input type="password" id="pass" /> <br> <br> <input
					type="button" id="loginButton" value="Log In" onclick="login()" />
				<br> <br>
				<p style="color: red; visibility: hidden" id="fail">Login
					failed! Double check your login info, or create a new user.</p>
					<br>
					<input type="button" value="Create new user" onclick="createNew()"/>
			</div>
		</div>

	</div>

	<script src="scripts/cookiehandler.js"></script>
	<script src="scripts/jquery-1.12.4.min.js"></script>
	<script src="scripts/bootstrap.min.js"></script>
	<script>
		var hostURL = window.location.host;
		function login() {
			var pm = $("#uname").val();
			var pass = $("#pass").val();
			var testResource = "http://" + hostURL
					+ "/pmportal/rest/test/login/" + pm + "/" + pass;
			$.ajax({
				type : "GET",
				dataType : "text",
				url : testResource
			}).fail(function(xhr, status, errorThrown) {
				console.log("Error: " + errorThrown);
				console.log("Status: " + status);
				console.dir(xhr);
				alert("Failed to contact server!");
			}).done(function(response) {
				if (response == "Success") {
					window.location = "select.html?user=" + uname;
				} else {
					$("#fail").css("visibility", "visible");
				}
				;
			});
		};
		
		function createNew(){
			window.location="new.html";
		}
	</script>
</body>
</html>
